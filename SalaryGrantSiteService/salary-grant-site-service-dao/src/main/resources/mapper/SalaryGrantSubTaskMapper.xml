<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ciicsh.gto.fcbusinesscenter.salarygrant.siteservice.dao.SalaryGrantSubTaskMapper">

	<!-- 通用查询映射结果 -->
	<resultMap id="BaseResultMap" type="com.ciicsh.gto.fcbusinesscenter.salarygrant.siteservice.entity.po.SalaryGrantSubTaskPO">
		<id column="salary_grant_sub_task_id" property="salaryGrantSubTaskId" />
		<result column="salary_grant_sub_task_code" property="salaryGrantSubTaskCode" />
		<result column="salary_grant_main_task_code" property="salaryGrantMainTaskCode" />
		<result column="work_flow_process_id" property="workFlowProcessId" />
		<result column="management_id" property="managementId" />
		<result column="management_name" property="managementName" />
		<result column="batch_code" property="batchCode" />
		<result column="grant_cycle" property="grantCycle" />
		<result column="payment_total_sum" property="paymentTotalSum" />
		<result column="total_person_count" property="totalPersonCount" />
		<result column="chinese_count" property="chineseCount" />
		<result column="foreigner_count" property="foreignerCount" />
		<result column="grant_date" property="grantDate" />
		<result column="grant_time" property="grantTime" />
		<result column="grant_account_code" property="grantAccountCode" />
		<result column="grant_type" property="grantType" />
		<result column="grant_mode" property="grantMode" />
		<result column="is_adversion" property="isAdversion" />
		<result column="adversion_type" property="adversionType" />
		<result column="remark" property="remark" />
		<result column="approved_opinion" property="approvedOpinion" />
		<result column="task_status" property="taskStatus" />
		<result column="task_type" property="taskType" />
        <result column="operator_user_id" property="operatorUserId" />
        <result column="approve_user_id" property="approveUserId" />
		<result column="is_active" property="isActive" />
		<result column="created_by" property="createdBy" />
		<result column="created_time" property="createdTime" />
		<result column="modified_by" property="modifiedBy" />
		<result column="modified_time" property="modifiedTime" />
	</resultMap>

    <resultMap id="PageResultMap" type="com.ciicsh.gto.fcbusinesscenter.salarygrant.siteservice.entity.bo.SalaryGrantTaskBO">
        <result column="task_id" property="taskId" />
        <result column="task_code" property="taskCode" />
        <result column="management_id" property="managementId" />
        <result column="management_name" property="managementName" />
        <result column="batch_code" property="batchCode" />
        <result column="grant_cycle" property="grantCycle" />
        <result column="payment_total_sum" property="paymentTotalSum" />
        <result column="total_person_count" property="totalPersonCount" />
        <result column="chinese_count" property="chineseCount" />
        <result column="foreigner_count" property="foreignerCount" />
        <result column="grant_date" property="grantDate" />
        <result column="grant_type" property="grantType" />
        <result column="grant_type_name" property="grantTypeName" />
        <result column="grant_mode" property="grantMode" />
        <result column="grant_mode_name" property="grantModeName" />
        <result column="grant_account_code" property="grantAccountCode" />
        <result column="grant_account_name" property="grantAccountName" />
        <result column="remark" property="remark" />
        <result column="invalid_reason" property="invalidReason" />
        <result column="approved_opinion" property="approvedOpinion" />
        <result column="task_status" property="taskStatus" />
        <result column="task_status_name" property="taskStatusName" />
    </resultMap>

	<sql id="subTaskListField">
        t.salary_grant_sub_task_id task_id,t.salary_grant_sub_task_code task_code,t.grant_mode,'' as grant_mode_name,t.grant_account_code,t.payment_total_sum,t.total_person_count,t.chinese_count,t.foreigner_count,t.task_status,'' as task_status_name
	</sql>

	<select id="subTaskList" resultMap="BaseResultMap">
		select
		  <include refid="subTaskListField"></include>
		from
          sg_salary_grant_sub_task t1
		<where>
			<if test="taskCode != null and taskCode != ''">
				and t1.salary_grant_main_task_code = #{taskCode}
			</if>
			and
			  t1.is_active=1
		</where>
          order by t.grant_mode,t.salary_grant_sub_task_code
	</select>

</mapper>
